default:
  &default # 共通の設定に「default」という名前(アンカー)を付けて再利用するため
  adapter: postgresql # Railsが使うデータベースはPostgreSQLだよ、という指定
  encoding: unicode # 文字コードはUTF-8相当。日本語も安心して保存できる
  pool: <%= ENV.fetch("RAILS_MAX_THREADS") { 5 } %> # 同時接続の上限。Railsのスレッド数に合わせ、未設定なら5
  host: db # 接続先ホスト名。Docker Composeのサービス名(db)でコンテナ間DNSが引ける
  username: postgres # DBのユーザー名（Composeの環境変数と合わせる）
  password: password # DBのパスワード（同じくCompose側と合わせる）

development:
  <<: *default # さっきの共通設定(*default)を丸ごと継承（YAMLのアンカー/エイリアス）
  database: mochibe_development # 開発用の“実際のDB名”。環境ごとに分けてデータ混ざりを防ぐ

test:
  <<: *default
  database: mochibe_test # テスト用のDB名。RSpecなどがここを使って安全に試験できる

production:
  primary:
    <<: *default
    url: <%= ENV['DATABASE_URL'] %> # Renderが自動設定するDATABASE_URLを使用
  cable:
    <<: *default
    url: <%= ENV['DATABASE_URL'] %> # Solid Cable用（同じDBを使用）
    migrations_paths: db/cable_migrate
  queue:
    <<: *default
    url: <%= ENV['DATABASE_URL'] %> # Solid Queue用（同じDBを使用）
    migrations_paths: db/queue_migrate
  cache:
    <<: *default
    url: <%= ENV['DATABASE_URL'] %> # Solid Cache用（同じDBを使用）
    migrations_paths: db/cache_migrate
