default:
  &default # 共通の設定に「default」という名前(アンカー)を付けて再利用するため
  adapter: postgresql # Railsが使うデータベースはPostgreSQLだよ、という指定
  encoding: unicode # 文字コードはUTF-8相当。日本語も安心して保存できる
  pool: <%= ENV.fetch("RAILS_MAX_THREADS") { 5 } %> # 同時接続の上限。Railsのスレッド数に合わせ、未設定なら5
  host: db # 接続先ホスト名。Docker Composeのサービス名(db)でコンテナ間DNSが引ける
  username: postgres # DBのユーザー名（Composeの環境変数と合わせる）
  password: password # DBのパスワード（同じくCompose側と合わせる）

development:
  <<: *default # さっきの共通設定(*default)を丸ごと継承（YAMLのアンカー/エイリアス）
  database: mochibe_development # 開発用の“実際のDB名”。環境ごとに分けてデータ混ざりを防ぐ

test:
  <<: *default
  database: mochibe_test # テスト用のDB名。RSpecなどがここを使って安全に試験できる

production:
  primary: &primary_production
    <<: *default
    url: <%= ENV['DATABASE_URL'] %>

  cable:
    <<: *primary_production

  queue:
    <<: *primary_production

  cache:
    <<: *primary_production
